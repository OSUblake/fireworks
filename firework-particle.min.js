class FireworkParticle extends DisplayObject{constructor(fireworks,settings){super(fireworks),Object.assign(this,{alive:!1,alpha:1,centered:!1,dx:0,dy:0},settings),this.size=fireworks.particleSize,this.originX=this.size/2,this.originY=this.size/2}init(cx,cy,currentRotation){const{dx:dx,dy:dy,fireworks:fireworks}=this,{duration:duration,friction:friction,gravity:gravity,scale:scale,skew:skew,spread:spread,startAlpha:startAlpha,rotation:rotation,velocity:velocity}=fireworks.particleVars;this.rotation=Math.random()*Math.PI,this.alpha=startAlpha(),this.scaleX=this.scaleY=scale(),this.skewX=skew(),this.skewY=skew();let angle=0,minAngle=0,maxAngle=360,frictionValue=friction();frictionValue=randomChoice(Math.min(2*frictionValue,.8),frictionValue,.3);const cos=Math.cos(currentRotation),sin=Math.sin(currentRotation);this.x=cos*dx-sin*dy+cx,this.y=cos*dy+sin*dx+cy,angle=Math.atan2(this.y-cy,this.x-cx)*DEG,minAngle=angle-spread,maxAngle=angle+spread,fireworks.clusterParticles&&this.centered&&(this.x=cx,this.y=cy,angle=0,minAngle=0,maxAngle=360),this.timeline=gsap.timeline({paused:!0}).to(this,{duration:duration,alpha:0,onComplete:()=>this.kill()},.2).to(this,{duration:duration,scaleX:0,scaleY:0},0).to(this,{duration:duration,physics2D:{angle:gsap.utils.random(minAngle,maxAngle),friction:frictionValue,velocity:velocity,gravity:gravity}},0)}play(){this.timeline?(this.alive=!0,this.timeline.play()):console.log("*** No particle timeline")}kill(){this.timeline.kill(),this.alive=!1}render(){if(!this.alpha||!this.scaleX&&!this.scaleY)return;const{fireworks:fireworks,frame:frame}=this,ctx=fireworks.ctx;this.setTransform(),ctx.globalAlpha=this.alpha,ctx.drawImage(frame.texture,frame.sx,frame.sy,frame.sSize,frame.sSize,0,0,frame.dSize,frame.dSize)}}